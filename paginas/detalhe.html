<!doctype html>
<html lang="pt-br" class="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ficha do Aluno — SAE</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght@100..700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="../css/base.css" />
  <link rel="stylesheet" href="../css/detalhe.css" />
  <!-- Biblioteca para PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>
  <header class="topbar-det">
    <div class="topbar-det__esquerda">
      <a href="javascript:history.back()" class="link-voltar"><span class="material-symbols-outlined">arrow_back</span> Voltar</a>
      <div class="marca">
        <img src="../img/KBT_logo2.png" alt="Logo" class="logo-icon">
        <h2 class="marca__titulo">Ficha do Aluno</h2>
      </div>
    </div>
    <div class="topbar-det__direita">
      <span id="badgeStatus" class="status-pill">Pendente</span>
    </div>
  </header>

  <main class="pagina-det">
    <div class="pagina-det__conteudo">
      
      

      <section class="hero">
        <div class="hero__info">
          <h1 id="detAluno" class="hero__nome">Carregando...</h1>
          <div class="hero__grid">
            <div class="mini-card"><p class="mini-card__label">Data</p><p id="detData">—</p></div>
            <div class="mini-card"><p class="mini-card__label">Tipo</p><p id="detTipo">—</p></div>
            <div class="mini-card"><p class="mini-card__label">WhatsApp</p><p id="detWhatsapp">—</p></div>
            <div class="mini-card"><p class="mini-card__label">Status</p><p id="detStatus">—</p></div>
          </div>

          <div class="acoes">
            <a id="btnWhatsapp" class="btn btn--primario" target="_blank"><span class="material-symbols-outlined">chat</span> WhatsApp</a>
            
            <div id="containerAdminAcoes" class="admin-presenca-area" style="display: none;">
              <div class="admin-botoes-row">
                <button id="btnConfirmar" class="btn btn--ok">Confirmar Presença</button>
                <button id="btnFaltou" class="btn btn--erro">Marcar Falta</button>
              </div>
              <!-- PAINEL ADMIN: MATRÍCULA -->
      <section id="secaoAdminVenda" class="card card--venda-admin" style="display: none;">
        <div class="admin-venda-wrapper">
          <p>Aluno realizou a matrícula?</p>
          <input type="checkbox" id="checkMatriculado">
        </div>
      </section>
              <label class="check-recepcao">
                <input type="checkbox" id="checkRecepcao"> Coach levou o aluno à recepção?
              </label>
            </div>
          </div>
        </div>
      </section>

      <!-- RELATÓRIO TÉCNICO (VIVÊNCIA) -->
      <section class="card card-feedback">
        <div class="card__topo">
          <h3 style="margin:0; display: flex; align-items: center; gap: 8px;">
            <span class="material-symbols-outlined">analytics</span> Relatório de Vivência Kabuto
          </h3>
        </div>

        <!-- SELETOR (COACH) -->
        <div id="seletorCategoria" style="margin: 20px 0; display: none;">
          <p style="font-weight: 800; font-size: 13px; margin-bottom: 10px;">Categoria do Aluno:</p>
          <div style="display: flex; gap: 10px;">
            <button type="button" class="btn btn--secundario" id="btnRelAdulto">Adulto</button>
            <button type="button" class="btn btn--secundario" id="btnRelKids">Kids</button>
          </div>
        </div>

        <!-- FORMULÁRIO (COACH) -->
        <div id="containerFeedbackCoach" style="display: none;">
          <form id="formRelatorioVivencia">
            <div id="camposRelatorio"></div>
            
            <p style="font-weight: 800; margin-top: 20px; font-size: 14px;">Tradução Prática (Insight Automático):</p>
            <textarea id="txtTraducaoPratica" placeholder="O sistema sugerirá um texto baseado na menor nota..."></textarea>
            
            <div id="recomendacaoArea" style="margin-top: 20px; padding: 15px; background: #f0f2f4; border-radius: 12px;">
                <p style="font-weight:800; margin:0; font-size:11px; color:#666; text-transform: uppercase;">Recomendação baseada na média:</p>
                <div id="textoRecomendacaoAuto" style="font-size: 16px; font-weight: 900; color: var(--primario); margin-top: 5px;">Selecione as notas...</div>
            </div>

            <button type="submit" class="btn btn--primario" style="width: 100%; margin-top: 20px;">Salvar Relatório Técnico</button>
          </form>
        </div>

        <!-- LEITURA E PDF (ADMIN) -->
        <div id="containerFeedbackAdmin" style="display: none;">
            <button id="btnExportarPDFVivencia" class="btn btn--secundario" style="width: 100%; margin-bottom: 15px; border: 1px solid var(--primario); color: var(--primario);">
                <span class="material-symbols-outlined">picture_as_pdf</span> Exportar Relatório para Aluno/Pais
            </button>
            <div id="leituraRelatorio" class="feedback-admin-box"></div>
        </div>
      </section>

      <!-- No final do detalhe.html -->
      <section class="card">
          <h3 class="card-feedback-titulo">Informações do Agendamento (Forms)</h3>
          <div id="detFormRaw" class="lista-detalhes">
          <!-- O JS preenche aqui -->
          </div>
      </section>
    </div>
  </main>

  <script type="module" src="../js/guardas.js"></script>
  <script type="module" src="../js/professor.detalhe.js"></script>
</body>
</html>